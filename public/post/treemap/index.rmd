---
authors:
- admin
date: "2019-07-03"
draft: true
gallery_item:
image:
  caption: ''
  focal_point: "left"
  preview_only: false
lastmod: "2019-07-03T00:00:00-08:00"
summary: An interactive treemap using treemap and d3treeR
projects:
- viz
tags:
- R
- Statistical analysis 
- Data viz
title: 'An interactive treemap of media franchise revenue by category'
---


## Background
To practice my data visualization skills, I decided to enter the this week's [#TidyTuesday](https://twitter.com/hashtag/TidyTuesday?src=hash) challege, which is about how different media franchises stack up with their revenue streams. You can read more about the dataset [here](https://github.com/rfordatascience/tidytuesday/tree/master/data/2019/2019-07-02). 


## Data visualization

```{r warning=FALSE}
library(dplyr)
library(ggplot2)
library(d3treeR)
library(treemap)
library(RColorBrewer)
dat <- read.csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-07-02/media_franchises.csv")

head(dat)

dat2 <- dat[!duplicated(dat), ]

dat2 %>% group_by(revenue_category) %>% summarise(n())
``` 

By briefly looking at the data, I realized that it has several categorical variables, one of which might have many distinct levels. Therefore, using the traditional barplot might not be a good idea here unless only a subset of the data is shown here. So, it occurred to me that the treemap might be a good idea. So far, [`treemap`](https://cran.r-project.org/web/packages/treemap/index.html) is very handy and straightforward to use compared to other similar R packages. 

```{r}
treemap(
   dat2,
   index=c("revenue_category", "franchise"),
   vSize="revenue",
   vColor="revenue",
   type="value",
   fun.aggregate="max"
)
```

Basically, you can get a very pretty treemap with a few codes. However, it doesn't really differentiate different revenue category. Wouldn't it be better that each revenue category gets its own color which changes with revenue decreasing? Intuitively, it doesn't seem a difficult task to implement. But 


### Interactive treemap


  